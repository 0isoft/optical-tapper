Version 4
SHEET 1 14936 824
WIRE 336 -336 336 -368
WIRE 2384 -288 2176 -288
WIRE 2560 -288 2464 -288
WIRE 2656 -288 2560 -288
WIRE 1360 -256 1296 -256
WIRE 1472 -256 1440 -256
WIRE 1552 -256 1472 -256
WIRE 1472 -240 1472 -256
WIRE 1296 -176 1296 -256
WIRE 1296 -176 1136 -176
WIRE -512 -144 -592 -144
WIRE 2416 -112 2416 -160
WIRE -288 -96 -288 -160
WIRE -208 -96 -288 -96
WIRE 1808 -96 1808 -144
WIRE -432 -80 -432 -144
WIRE -368 -80 -432 -80
WIRE -208 -80 -368 -80
WIRE -208 -64 -288 -64
WIRE 64 -64 16 -64
WIRE 96 -64 64 -64
WIRE 2672 -32 2416 -32
WIRE -432 -16 -432 -80
WIRE 192 0 160 0
WIRE 256 0 240 0
WIRE 304 0 256 0
WIRE 416 0 304 0
WIRE 560 0 496 0
WIRE -288 16 -288 -64
WIRE 304 16 304 0
WIRE 2416 16 2416 -32
WIRE 1808 48 1808 -16
WIRE 1936 48 1936 -80
WIRE 1936 48 1808 48
WIRE 1968 48 1936 48
WIRE 16 64 16 -64
WIRE 3312 64 3152 64
WIRE 3520 64 3392 64
WIRE 3664 64 3584 64
WIRE 1456 80 1392 80
WIRE 1616 80 1520 80
WIRE -48 112 -48 96
WIRE -48 112 -272 112
WIRE -16 112 -48 112
WIRE 2416 128 2416 96
WIRE 160 144 160 0
WIRE 160 144 128 144
WIRE 240 144 160 144
WIRE 368 144 240 144
WIRE 480 144 448 144
WIRE 1808 160 1808 128
WIRE -16 176 -80 176
WIRE 2160 176 1952 176
WIRE 1392 192 1392 80
WIRE 1392 192 1184 192
WIRE 1440 192 1392 192
WIRE 1536 192 1520 192
WIRE 1616 192 1616 80
WIRE 1616 192 1536 192
WIRE 1536 208 1536 192
WIRE 1984 256 1952 256
WIRE 240 272 240 144
WIRE 368 272 240 272
WIRE 480 272 480 144
WIRE 480 272 432 272
WIRE 1296 272 1296 256
WIRE 2048 272 2048 240
WIRE 2576 272 2432 272
WIRE 2864 272 2656 272
WIRE 1952 288 1808 288
WIRE 1952 304 1952 288
WIRE 1984 304 1984 256
WIRE 1984 304 1952 304
WIRE 2016 304 1984 304
WIRE 2160 304 2160 176
WIRE 2160 304 2096 304
WIRE 2192 304 2160 304
WIRE 2576 304 2432 304
WIRE 1184 320 1184 192
WIRE 1264 320 1184 320
WIRE 2016 336 1856 336
WIRE 2192 336 2192 304
WIRE 2224 336 2224 304
WIRE 2224 336 2192 336
WIRE 16 352 16 224
WIRE 1616 352 1616 192
WIRE 1616 352 1408 352
WIRE 1152 384 1152 288
WIRE 1264 384 1152 384
WIRE 2032 384 2032 368
WIRE -272 400 -272 112
WIRE 480 400 480 272
WIRE 480 400 -272 400
WIRE -1088 448 -1088 432
WIRE 1296 496 1296 432
WIRE -1088 544 -1088 528
FLAG -80 176 0
FLAG -592 -64 0
FLAG -496 -16 0
FLAG -48 96 SUM
FLAG 128 144 VOUT
FLAG -288 -160 SUM
FLAG -288 16 OPT
FLAG -1088 544 0
FLAG -1088 432 OPT
FLAG -368 -80 BIAS
FLAG 336 -256 0
FLAG 336 -368 VDD
FLAG 96 -64 vdd
FLAG 64 0 0
FLAG 528 -272 0
FLAG 528 -352 -2.5
FLAG 16 352 -2.5
FLAG 304 96 0
FLAG 560 0 TIA_out
FLAG 1152 288 TIA_out
FLAG 1536 208 buffer_out
FLAG 1296 496 -2.5
FLAG 1296 256 vdd
FLAG 1392 272 0
FLAG 2032 384 0
FLAG 1856 336 buffer_out
FLAG 1808 -144 vdd
FLAG 1808 160 0
FLAG 1968 48 dc_reference
FLAG 2048 240 vdd
FLAG 2224 304 comparator_out
FLAG 1808 288 dc_reference
FLAG 2064 368 0
FLAG 2048 368 0
FLAG 2608 240 vdd
FLAG 2592 336 0
FLAG 2608 336 0
FLAG 2624 336 0
FLAG 2416 -160 vdd
FLAG 2416 128 0
FLAG 2672 -32 dc_reference2
FLAG 2432 272 comparator1_DC_value
FLAG 2432 304 comparator_out
FLAG 2864 272 comparator2_out
FLAG 1136 -176 buffer_out
FLAG 1552 -256 buffer_DC_value
FLAG 1472 -176 0
FLAG 2560 -224 0
FLAG 2176 -288 comparator_out
FLAG 2656 -288 comparator1_DC_value
FLAG 1936 -160 buffer_DC_value
FLAG -368 0 0
FLAG 3152 64 comparator2_out
FLAG 3664 64 fpga_in
SYMBOL OpAmps\\LTC6268 16 144 R0
SYMATTR InstName U1
SYMBOL KPDE030 -160 -80 R0
SYMATTR InstName X1
SYMATTR Prefix X
SYMATTR Value KPDE030
SYMATTR SpiceModel KPDE030
SYMBOL voltage -592 -160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 44 Left 2
SYMATTR InstName V2
SYMATTR Value 2.5
SYMBOL cap -432 -32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 10n
SYMBOL voltage -1088 432 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 1
SYMATTR InstName V1
SYMATTR Value PWL( 0n 0.195u 20n 0.437u 40n 0.195u 60n 0.195u 80n 0.437u  100n 0.437u 120n 0.437u 140n 0.195u 160n 0.437u 180n 0.195u 200n 0.437u 220n 0.437u 240n 0.195u 260n 0.195u 280n 0.195u 300n 0.437u 320n 0.437u 340n 0.437u 360n 0.195u 380n 0.195u 400n 0.437u 420n 0.195u 440n 0.195u 460n 0.437u 480n 0.195u 500n 0.437u 520n 0.437u 540n 0.437u 560n 0.437u 580n 0.195u 600n 0.195u 620n 0.195u 640n 0.437u 660n 0.195u 680n 0.195u 700n 0.195u 720n 0.195u 740n 0.437u 760n 0.437u 780n 0.195u 800n 0.195u 820n 0.437u 840n 0.437u 860n 0.195u 880n 0.437u 900n 0.195u 920n 0.195u 940n 0.195u 960n 0.195u 980n 0.195u 1000n 0.437u 1020n 0.195u 1040n 0.437u 1060n 0.195u 1080n 0.437u 1100n 0.195u 1120n 0.195u 1140n 0.437u 1160n 0.437u 1180n 0.437u 1200n 0.437u 1220n 0.437u 1240n 0.437u 1260n 0.195u 1280n 0.437u 1300n 0.437u 1320n 0.195u 1340n 0.437u 1360n 0.195u 1380n 0.437u 1400n 0.437u 1420n 0.437u 1440n 0.195u 1460n 0.195u 1480n 0.437u 1500n 0.195u 1520n 0.437u 1540n 0.437u 1560n 0.195u 1580n 0.195u 1600n 0.195u 1620n 0.195u 1640n 0.437u 1660n 0.195u 1680n 0.437u 1700n 0.437u 1720n 0.437u 1740n 0.195u 1760n 0.437u 1780n 0.437u 1800n 0.437u 1820n 0.437u 1840n 0.195u 1860n 0.437u 1880n 0.195u 1900n 0.195u 1920n 0.437u 1940n 0.195u 1960n 0.195u 1980n 0.195u)
SYMBOL res -416 -160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL voltage 336 -352 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 2.5
SYMBOL cap 48 -64 R0
SYMATTR InstName C2
SYMATTR Value 0.5µ
SYMBOL res 464 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 5k
SYMBOL cap 432 256 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 0.5p
SYMBOL voltage 528 -368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value -2.5
SYMBOL cap 256 -16 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 10n
SYMBOL res 288 0 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 1376 176 R0
SYMATTR InstName R4
SYMATTR Value 1.5k
SYMBOL res 1536 176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 5k
SYMBOL OpAmps\\LTC6228 1296 352 R0
SYMATTR InstName U2
SYMBOL cap 1520 64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 1p
SYMBOL res 512 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 30
SYMBOL Comparators\\LT1711 2048 320 R0
SYMATTR InstName U3
SYMBOL res 1792 -112 R0
SYMATTR InstName R7
SYMATTR Value 3.215k
SYMBOL res 1792 32 R0
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL res 1936 160 R0
SYMATTR InstName R9
SYMATTR Value 30k
SYMBOL Comparators\\LT1711 2608 288 R0
SYMATTR InstName U4
SYMBOL res 2400 -128 R0
SYMATTR InstName R10
SYMATTR Value 3k
SYMBOL res 2400 0 R0
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL res 1456 -272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 316
SYMBOL cap 1456 -240 R0
WINDOW 3 28 56 Left 2
SYMATTR Value 1n
SYMATTR InstName C6
SYMBOL res 2480 -304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 316
SYMBOL cap 2544 -288 R0
WINDOW 3 28 56 Left 2
SYMATTR Value 1n
SYMATTR InstName C7
SYMBOL res 1920 -176 R0
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL res -384 -96 R0
SYMATTR InstName R15
SYMATTR Value 115k
SYMBOL res 3408 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 33
SYMBOL cap 3584 48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C8
SYMATTR Value 5p
TEXT -416 -232 Left 2 !.include "KPDE030.lib"
TEXT -696 240 Left 2 !;.ac dec 100 10k 1G
TEXT -944 448 Left 2 !.tran 0 2u 0 10p
TEXT -992 160 Left 2 !.param P_opt=0.195u
TEXT -1448 -384 Left 2 !;noise V(TIA_out) V1 lin 100000 100 100Meg\n.meas noise Vn_10k FIND V(onoise) AT 10k\n.meas noise Vn_1M FIND V(onoise) AT 1Meg\n.meas noise Vn_50M FIND V(onoise) AT 50Meg\n.meas noise Vn2 INTEG(V(onoise)*V(onoise)) FROM 1k TO 60Meg\n.meas noise VnRMS PARAM sqrt(Vn2)
